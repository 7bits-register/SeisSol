stages:
    - build
    
dbuilder:
    stage: build
    tags:
        - dbuilder_cc
    before_script:
        - git branch -vva
        - git log --format="%H" -n 1
        - git log --format="%H" -n 1 > commit_id
        - git --no-pager show -s --format='%ae' $commit_id
        - commit_author_name=$(git --no-pager show -s --format='%ae' $commit_id) 
        - echo $commit_author_name
    script:
        - whoami
        - pwd
        - echo $PATH
        - echo $NAME_TEST
        - echo $TEST_VAR
        - echo $CI_REGISTRY $CI_REGISTRY_IMAGE $CI_REGISTRY_USER
        - git submodule update --init --recursive
        - cmake --version
        - set -euo pipefail
        - export IFS=$'\n\t'
        - export CTEST_OUTPUT_ON_FAILURE=1
        - equation=elastic
        - mechanisms=0
        - precision=double
        - build_type=Release 
        - dirname="build_${equation}_${precision}_${build_type}"
        - echo "mkdir $dirname"
        - mkdir -p $dirname && cd $dirname
        - pwd
